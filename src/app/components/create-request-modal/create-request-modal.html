<div
  class="fixed inset-0 z-[1300] bg-black/55 flex items-start justify-center overflow-y-auto p-4 sm:p-6">

  <div class="my-4 sm:my-8 bg-white rounded-xl p-6 sm:p-8 w-full max-w-lg space-y-6 shadow-2xl">

    <div class="flex justify-between items-center">
      <h3 class="text-xl font-semibold">Create Scan Request</h3>
      <button
        class="text-slate-400 hover:text-slate-600"
        (click)="close.emit()">
        x
      </button>
    </div>

    <div
      *ngIf="businessTrialNotice"
      class="rounded-lg border border-amber-300 bg-amber-50 px-3 py-2 text-sm text-amber-700">
      {{ businessTrialNotice }}
    </div>

    <!-- Target (Admin) -->
    <div>
      <label class="label" for="requester-name">Requested By</label>
      <input
        #requestedByInput
        class="input"
        id="requester-name"
        [value]="requestedByDefault"
        placeholder="Company or admin name" />
    </div>

    <!-- Requested For -->
    <div>
      <label class="label" for="request-user-id">Requested For (Email or Phone)</label>
      <input
        #requestedForInput
        class="input"
        id="request-user-id"
        placeholder="name@email.com or +201234567890" />
      <p class="text-xs text-slate-500 mt-2">
        We will send an invite if the user is not registered yet.
      </p>
      <p
        *ngIf="businessInviteTrialNotice"
        class="text-xs text-amber-600 mt-2">
        {{ businessInviteTrialNotice }}
      </p>
    </div>

    <div>
      <label class="label" for="request-invite-channel">Invite Channel</label>
      <select
        #inviteChannelInput
        class="input"
        id="request-invite-channel">
        <option value="auto">Auto (Email for email, WhatsApp for phone)</option>
        <option value="email">Email</option>
        <option value="whatsapp">WhatsApp</option>
        <option value="sms">SMS</option>
      </select>
    </div>

    <!-- Required State -->
    <div>
      <label class="label" for="request-required-state">Required Scan State</label>
      <select
        #requiredStateInput
        class="input"
        id="request-required-state">
        <option>Stable</option>
        <option>Low Focus</option>
        <option>Elevated Fatigue</option>
        <option>High Risk</option>
      </select>
    </div>

    <!-- Notes -->
    <div>
      <label class="label" for="request-notes">Notes (optional)</label>
      <textarea
        #notesInput
        id="request-notes"
        rows="3"
        class="input"
        placeholder="Why is this scan required?"></textarea>
    </div>

    <button
      type="button"
      class="btn-primary w-full disabled:opacity-60 disabled:cursor-not-allowed"
      [disabled]="submitting"
      (click)="onSubmit(requestedByInput.value, requestedForInput.value, requiredStateInput.value, notesInput.value, inviteChannelInput.value)">
      Send Request
    </button>
    <p
      *ngIf="feedback as info"
      class="text-sm"
      [ngClass]="{
        'text-green-600': info.type === 'success',
        'text-red-500': info.type === 'error',
        'text-slate-500': info.type === 'info'
      }">
      {{ info.message }}
    </p>

  </div>
</div>
